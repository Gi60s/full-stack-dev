
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Full Stack Web Development | NodeJS and NPM</title>
  

  <link rel="icon" href="/full-stack-dev/favicon.png">

  <link rel="stylesheet" href="/full-stack-dev/template-files/styles/main.css" media="all">
  
  
  <link rel="stylesheet" href="/full-stack-dev/css/main.css" media="all">
  
  
  
</head>

<body>
  <header class="site-header">
    <div class="wrapper">
      <a class="site-title" href="/full-stack-dev">
        Full Stack Web Development
      </a>

      
      <nav class="site-nav">
        <a href="#" class="menu-icon" aria-label="Menu">
          <svg viewBox="0 0 18 15">
            <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
            <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
            <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
          </svg>
        </a>
      </nav>
      
    </div>
  </header>

<div class="page-content">
  <div class="wrapper">

    
    <div class="nav-screen"></div>
    <nav class="nav-list"><ul><li><a href="/full-stack-dev">Home</a></li><li><a href="/full-stack-dev/history">History of the Web</a></li><li><a href="/full-stack-dev/domain-driven-design">Domain Driven Design</a></li><li><a href="/full-stack-dev/git">Git</a></li><li><a href="/full-stack-dev/rest">REST</a></li><li><a href="/full-stack-dev/javascript">JavaScript Fundamentals</a></li><li><a href="/full-stack-dev/node-and-npm" class="current-page">NodeJS and NPM</a></li><li><a href="/full-stack-dev/express">Express</a></li><li><a href="/full-stack-dev/testing-intro">Testing Introduction</a></li><li><a href="/full-stack-dev/testing-nodejs">Testing NodeJS</a></li><li><a href="/full-stack-dev/async-javascript">Asynchronous JavaScript</a></li><li><a href="/full-stack-dev/events">Events</a></li><li><a href="/full-stack-dev/docker-intro">Docker Introduction</a></li><li><a href="/full-stack-dev/sql">SQL Databases</a></li><li><a href="/full-stack-dev/nosql">NoSQL Databases</a></li></ul></li></nav>
    

    <div class="page-content-main">
      <article class="post">
        <header class="post-header">
          
          <h1 class="post-title">NodeJS and NPM</h1>
        </header>

        
        <div>
          <p><strong>Page Content</strong></p>
          <div class="section-nav"><ul class="toc"><li><a href="#javascript-recap">JavaScript Recap</a></li><li><a href="#first-nodejs-file">First NodeJS File</a></li><li><a href="#modules">Modules</a></li><li><a href="#nodejs-core-modules">NodeJS Core Modules</a></li><li><a href="#packages">Packages</a></li><li><a href="#npm-run-scripts">NPM Run Scripts</a></li></ul></div>
        </div>
        

        <div class="post-content"><h1 id="javascript-recap">JavaScript Recap</h1>
<h2 id="about-javascript">About JavaScript</h2>
<ul>
<li><p>JavaScript is a scripted language.</p>
</li>
<li><p>An interpreter reads the code and executes it.</p>
</li>
<li><p>Web Browsers that are capable of executing JavaScript have a JavaScript interpreter.</p>
</li>
<li><p>The interpreters are known as JavaScript engines.</p>
</li>
<li><p>Most browsers have their own JavaScript engine, but some share the same engine.</p>
</li>
<li><p>NodeJS takes Chrome&#39;s V8 engine and uses it to run JavaScript on a server.</p>
</li>
</ul>
<h2 id="browser-javascript-vs-server-javascript">Browser JavaScript vs Server JavaScript</h2>
<ul>
<li><p>The language is identical.</p>
</li>
<li><p>The libraries are mostly different.</p>
<ul>
<li><p>Browser specific libraries: window, document, DOM, alert, etc.</p>
</li>
<li><p>NodeJS specific libraries: file system, network, operating system, cryptography, etc.</p>
</li>
</ul>
</li>
<li><p>In browser JavaScript, all files share the same global scope.</p>
</li>
<li><p>In NodeJS, all files are automatically wrapped in a closure.</p>
</li>
</ul>
<h1 id="first-nodejs-file">First NodeJS File</h1>
<p><strong>Exercise</strong></p>
<p>Create a <a href="/full-stack-dev/javascript#factory-functions">factory function</a> that returns an object that enables us to do the following:</p>
<ol>
<li>Add a string to the end of an array if it is unique.</li>
<li>Remove existing strings from the array.</li>
<li>Get an array of all of the strings in the array. Do not allow mutation of the internal array.</li>
<li>Get the number of entries.</li>
</ol>
<p>You may want to refer to the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">MDN Array Documentation</a>.</p>
<p>&lt;--</p>
<p>How would you write a factory function that accomplishes the above?</p>
<p>--</p>
<p>This is one way you could write it.</p>
<pre><code class="language-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StringList</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> factory = {}
  <span class="hljs-keyword">const</span> store = []

  factory.add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">if</span> (!store.includes(string)) store.push(string)
    <span class="hljs-keyword">return</span> factory
  }

  factory.remove = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">const</span> index = store.indexOf(string)
    <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) store.splice(index, <span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> factory
  }

  factory.list = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> store.slice(<span class="hljs-number">0</span>)
  }

  <span class="hljs-built_in">Object</span>.defineProperty(factory, <span class="hljs-string">'count'</span>, {
    <span class="hljs-keyword">get</span> () {
      <span class="hljs-keyword">return</span> store.length
    }
  })

  <span class="hljs-keyword">return</span> factory;
}

<span class="hljs-keyword">const</span> list = StringList()
list.add(<span class="hljs-string">'one'</span>)
list.add(<span class="hljs-string">'two'</span>)
list.add(<span class="hljs-string">'three'</span>)
<span class="hljs-built_in">console</span>.log(list.count) <span class="hljs-comment">// 3</span>
<span class="hljs-built_in">console</span>.log(list.list()) <span class="hljs-comment">// ['one', 'two', 'three']</span></code></pre>
<p>--&gt;</p>
<h1 id="modules">Modules</h1>
<!--

What does it mean if something is modular?

--

It is constructed in such a way that it can be easily reused in a variety of ways.

-->

<p>&lt;--</p>
<p>What is a module in code?</p>
<p>--</p>
<p>It is a small set of code with a specific purpose. It is reusable in many instances and along with other modules to produce code with more complex capabilities.</p>
<p>--&gt;</p>
<p>In NodeJS:</p>
<ul>
<li><p>Each file is a module.</p>
</li>
<li><p>Each module (file) is automatically wrapped with a closure. To be precise, this closure:</p>
<p>  <a href="https://nodejs.org/api/modules.html#modules_the_module_wrapper">NodeJS Module Wrapper</a></p>
<pre><code class="language-js">  (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">exports, require, module, __filename, __dirname</span>) </span>{
      <span class="hljs-comment">// Your module code actually lives in here</span>
  });</code></pre>
</li>
<li><p>We can use the <code>exports</code> object to expose content inside our module to outside modules.</p>
</li>
<li><p>We can get that <code>exports</code> object in a different module by using the <code>require</code> function from that other module.</p>
</li>
</ul>
<h2 id="create-a-module">Create a Module</h2>
<p>This NodeJS module exports the StringList factory we created earlier so that it can be used elsewhere in our code.</p>
<p><strong>string-list.js</strong></p>
<pre><code class="language-js">exports.stringList = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> factory = {}
  <span class="hljs-keyword">const</span> store = []

  factory.add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">if</span> (!store.includes(string)) store.push(string)
    <span class="hljs-keyword">return</span> factory
  }

  factory.remove = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
    <span class="hljs-keyword">const</span> index = store.indexOf(string)
    <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) store.splice(index, <span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> factory
  }

  factory.list = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> store.slice(<span class="hljs-number">0</span>)
  }

  <span class="hljs-built_in">Object</span>.defineProperty(factory, <span class="hljs-string">'count'</span>, {
    <span class="hljs-keyword">get</span> () {
      <span class="hljs-keyword">return</span> store.length
    }
  })
}

<span class="hljs-comment">// this still runs the first time we require counter.js</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'String list factory created'</span>)</code></pre>
<h2 id="require-a-module">Require a Module</h2>
<p>NodeJS currently uses the CommonJS <code>requires</code> model. In the future it will use the ES6 module model.</p>
<p><strong>index.js</strong></p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> myFactory = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./string-list'</span>)      <span class="hljs-comment">// get the counter.js module</span>

<span class="hljs-keyword">const</span> stringList = myFactory()
stringList.add(<span class="hljs-string">'one'</span>)
stringList.add(<span class="hljs-string">'two'</span>)
stringList.add(<span class="hljs-string">'three'</span>)
<span class="hljs-built_in">console</span>.log(stringList.count) <span class="hljs-comment">// 3</span>
<span class="hljs-built_in">console</span>.log(stringList.list()) <span class="hljs-comment">// ['one', 'two', 'three']</span></code></pre>
<h3 id="modules-are-intended-to-create-apis">Modules are Intended to Create APIs</h3>
<p>&lt;--</p>
<p>What is an API?</p>
<p>--</p>
<p>It is an interface that provides some set of functionality. Imagine a black box that does a lot of stuff, but you don&#39;t care about the details of how it does it, you just need to be able to tell it to do it for you.</p>
<p>The <code>string-list.js</code> module exposes the StringList factory API.</p>
<p>--&gt;</p>
<h2 id="more-about-the-module-wrapper">More About the Module Wrapper</h2>
<pre><code class="language-js">(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">exports, require, module, __filename, __dirname</span>) </span>{
  <span class="hljs-comment">// Your module code actually lives in here</span>
  exports.stringList = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> factory = {}
    <span class="hljs-keyword">const</span> store = []

    factory.add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
      <span class="hljs-keyword">if</span> (!store.includes(string)) store.push(string)
      <span class="hljs-keyword">return</span> factory
    }

    factory.remove = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">string</span>) </span>{
      <span class="hljs-keyword">const</span> index = store.indexOf(string)
      <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) store.splice(index, <span class="hljs-number">1</span>)
      <span class="hljs-keyword">return</span> factory
    }

    factory.list = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> store.slice(<span class="hljs-number">0</span>)
    }

    <span class="hljs-built_in">Object</span>.defineProperty(factory, <span class="hljs-string">'count'</span>, {
      <span class="hljs-keyword">get</span> () {
        <span class="hljs-keyword">return</span> store.length
      }
    })
  }

  <span class="hljs-comment">// this still runs the first time we require counter.js</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'String list factory created'</span>)
});</code></pre>
<ul>
<li><p><em>exports</em> - An empty object that you can put properties on.</p>
</li>
<li><p><em>require</em> - A function that will get the value from the <code>module.exports</code> property of another file.</p>
</li>
<li><p><em>module</em> - An object with various properties. This object represents the current file as a module.</p>
<ul>
<li><p>This object has a property <code>exports</code> that is the same object as the exports variable. In other words: <code>exports === module.exports</code></p>
</li>
<li><p>Because of this you can export something other than an object from a module. More on this soon.</p>
</li>
</ul>
</li>
<li><p><em>__filename</em> - The filename plus full path on the hard drive to this current file.</p>
</li>
<li><p><em>__dirname</em> - The full directory path for the directory that contains this file.</p>
</li>
</ul>
<p>When another module requires this module, it executes the module as an <a href="/full-stack-dev/javascript#iife---immediately-invoked-functional-expression">IIFE</a>.</p>
<p>The following code example is not actually how the module get&#39;s required, it&#39;s more of a pseudo code to illustrate the point.</p>
<pre><code class="language-js"><span class="hljs-keyword">const</span> <span class="hljs-built_in">module</span> = {
  <span class="hljs-attr">exports</span>: {}
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">require</span> (<span class="hljs-params">modulePath</span>) </span>{ ... }

(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">exports, require, module, __filename, __dirname</span>) </span>{
  <span class="hljs-comment">// Your module code actually lives in here</span>
  exports.x = <span class="hljs-string">'Some value'</span>
})(<span class="hljs-built_in">module</span>.exports, <span class="hljs-built_in">require</span>, <span class="hljs-built_in">module</span>, <span class="hljs-string">'/path/to/module.js'</span>, <span class="hljs-string">'/path/to'</span>);</code></pre>
<h3 id="exporting-something-else">Exporting Something Else</h3>
<p>If you want to export a something other than an object you can use <code>module.exports</code>.</p>
<p>This WILL NOT work:</p>
<pre><code class="language-js">exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ ... }</code></pre>
<p>This WILL work:</p>
<pre><code class="language-js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{ ... }</code></pre>
<!--

What is the difference between these two examples?

--

The first example reassigns `exports` to a new value. The second example mutates the `module` object by updating a property on it.

-->

<p>Also remember that <code>require</code> gets the value from the <code>module.exports</code> property.</p>
<h1 id="nodejs-core-modules">NodeJS Core Modules</h1>
<ul>
<li><p>There are many core modules for NodeJS that allow you to interact with many parts of the server: file system, network, operating system, cryptography, etc.</p>
</li>
<li><p><a href="https://nodejs.org/en/docs/">API Documentation</a></p>
</li>
</ul>
<h1 id="packages">Packages</h1>
<ul>
<li><p>A package is a set of modules that are combined to produce a single API interface.</p>
</li>
<li><p>Node has a package manager called <code>npm</code>.</p>
</li>
<li><p>npm can be used for:</p>
<ul>
<li><p>Getting packages off the internet.</p>
</li>
<li><p>Keeping package dependencies up to date.</p>
</li>
<li><p>Deploying packages.</p>
</li>
<li><p>Providing run scripts for packages.</p>
</li>
<li><p>etc.</p>
</li>
</ul>
</li>
<li><p>Each project you work on is a package, whether it gets published or not.</p>
</li>
</ul>
<h2 id="create-a-package">Create a Package</h2>
<ol>
<li><p>From a terminal run <code>npm init</code> and follow the prompts.</p>
</li>
<li><p>Now we have a <code>package.json</code> file.</p>
<p> This file contains information about our package:</p>
<ul>
<li><p>Dependencies and their versions.</p>
</li>
<li><p>Run scripts.</p>
</li>
<li><p>Version</p>
</li>
<li><p>Name</p>
</li>
<li><p>etc.</p>
</li>
</ul>
</li>
<li><p>If you don&#39;t want to publish a package by mistake then you specify that the package is private in your <code>package.json</code>:</p>
<pre><code class="language-json"> {
     ...
     &quot;private&quot;: true
 }</code></pre>
</li>
</ol>
<h2 id="getting-a-package-dependency">Getting a Package Dependency</h2>
<p>We&#39;re going to get the <code>express</code> package that makes it easy to create a custom server.</p>
<ol>
<li><p>From the terminal run <code>npm install express</code></p>
<ul>
<li><p>Notice that <code>package.json</code> now has the <code>express</code> dependency.</p>
</li>
<li><p>This package come from <a href="https://npmjs.com">https://npmjs.com</a></p>
</li>
<li><p>The <a href="https://npmjs.com">npmjs.com</a> website is the official repository for all published packages.</p>
</li>
</ul>
</li>
<li><p>Lookup the express package to see documentation on how to use it.</p>
</li>
</ol>
<h1 id="npm-run-scripts">NPM Run Scripts</h1>
<p>What is an NPM run script?</p>
<ul>
<li><p>Allows you to define an alias for a command.</p>
</li>
<li><p>Runs the command with the <code>node_modules</code> directory in the path.</p>
</li>
</ul>
<p>You define your run scripts in the <code>package.json</code> file like this:</p>
<pre><code class="language-json">{
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"my-package"</span>,
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"start"</span>: <span class="hljs-string">"node index"</span>,
    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"mocha server/test"</span>,
    <span class="hljs-attr">"debug"</span>: <span class="hljs-string">"node inspect index"</span>
  }
}</code></pre>
<p>And you execute the scripts from the terminal like this:</p>
<ul>
<li><code>npm start</code></li>
<li><code>npm test</code></li>
<li><code>npm run debug</code></li>
</ul>
<p>Note that scripts named <code>start</code> and <code>test</code> are the only scripts that can be run without the <code>run</code> command and all other tests must use the <code>run</code> command.</p>
</div>
      </article>

      <footer class="site-footer">

        
        <p>
          Caught a mistake or want to contribute to the documentation?
          <a href="https://github.com/Gi60s/full-stack-dev/tree/master/docs-src/node-and-npm.md" target="_blank" rel="noopener">Edit this page on Github</a>
        </p>
        

        

        
        <div class="footer-links">
          
        </div>
        

      </footer>
    </div>

  </div>
</div>

<script src="/full-stack-dev/template-files/js/main.js"></script>


<script src="/full-stack-dev/js/main.js"></script>



</body>

</html>
